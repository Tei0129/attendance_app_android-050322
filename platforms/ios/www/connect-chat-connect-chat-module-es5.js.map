{"version":3,"sources":["webpack:///src/app/connect-chat/connect-chat.module.ts","webpack:///src/app/connect-chat/connect-chat-routing.module.ts","webpack:///src/app/connect-chat/connect-chat.page.scss","webpack:///src/app/connect-chat/connect-chat.page.ts","webpack:///src/app/connect-chat/connect-chat.page.html"],"names":["ConnectChatPageModule","imports","declarations","routes","path","component","ConnectChatPageRoutingModule","forChild","exports","ConnectChatPage","navCtrl","translate","dataProvider","authProvider","alertCtrl","_location","photoViewer","router","route","camera","userDetails","chat","message","messages","lastMessageId","attachment","lang","image","queryParams","subscribe","params","getCurrentNavigation","extras","state","console","log","navData","JSON","parse","localStorage","getItem","push","datetime","created","receiver","details","user_type","msg_from","parent_user_no","msg_to","school_id","attachment_url","message_image","id","getInitialChat","chatInterval","setInterval","getChats","get","response","url","show","showLoading","data","user_no","session_id","chat_id","last_msg_id","getParentConnectChatMessages","then","hideLoading","session","length","forEach","setTimeout","contentArea","scrollToBottom","errorALertMessage","navigate","replaceUrl","error","msgLength","msg","filter","oldMsg","_scroll","clearInterval","back","trim","showToast","max_body","chat_msg","connect_id","admin_user_no","sendParentConnectChatMsg","msg_id","create","header","image_option","buttons","text","handler","openCamera","gallery","openGallery","alert","present","options","quality","destinationType","DestinationType","DATA_URL","encodingType","EncodingType","PNG","mediaType","MediaType","PICTURE","allowEdit","correctOrientation","sourceType","PictureSourceType","CAMERA","targetHeight","targetWidth","getPicture","imageData","PHOTOLIBRARY","imageUrl","downloadImage","res","download_complete","selector","template"],"mappings":"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","file":"connect-chat-connect-chat-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ConnectChatPageRoutingModule } from './connect-chat-routing.module';\n\nimport { ConnectChatPage } from './connect-chat.page';\nimport { PipesModule } from '../pipes/pipes.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ConnectChatPageRoutingModule,\n    PipesModule\n  ],\n  declarations: [ConnectChatPage]\n})\nexport class ConnectChatPageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ConnectChatPage } from './connect-chat.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ConnectChatPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ConnectChatPageRoutingModule {}\n","export default \"app-connect-chat:host .margintop {\\n  margin-top: 8px !important;\\n}\\napp-connect-chat:host h6 {\\n  margin: 2vw;\\n}\\napp-connect-chat:host .avatar-img {\\n  width: 40px;\\n  height: 40px;\\n  background-position: center;\\n  background-size: cover;\\n  border-radius: 50%;\\n  margin-left: 9px;\\n}\\napp-connect-chat:host .sender-message {\\n  text-align: left;\\n  background: #43a047;\\n  color: #fff;\\n  padding: 7px;\\n  max-width: 100%;\\n  width: -webkit-fit-content;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  float: right;\\n  border-top-left-radius: 6px;\\n  border-bottom-left-radius: 6px;\\n  margin-right: 3px;\\n}\\napp-connect-chat:host .sender-message-first-child:after {\\n  width: 0;\\n  height: 0;\\n  content: \\\"\\\";\\n  top: 5px;\\n  right: -1px;\\n  position: absolute;\\n  border-style: solid;\\n  border-width: 13px 13px 0 0;\\n  border-color: #43a047 transparent transparent transparent;\\n}\\napp-connect-chat:host .receiver-message {\\n  background: #00b0ff;\\n  padding: 7px;\\n  max-width: 100%;\\n  width: -webkit-fit-content;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  border-top-right-radius: 6px;\\n  border-bottom-right-radius: 6px;\\n  display: flex;\\n  color: #fff;\\n  margin-left: 4px;\\n}\\napp-connect-chat:host .receiver-message-first-child:before {\\n  width: 0;\\n  height: 0;\\n  content: \\\"\\\";\\n  top: 5px;\\n  left: 1px;\\n  position: absolute;\\n  border-style: solid;\\n  border-width: 0 13px 13px 0;\\n  border-color: transparent #00b0ff transparent transparent;\\n}\\napp-connect-chat:host .receiver-message ul {\\n  margin: 0;\\n  padding: 0;\\n}\\napp-connect-chat:host .receiver-message ul li {\\n  list-style: none;\\n  margin: 0;\\n}\\napp-connect-chat:host li.sender-name {\\n  font-weight: bold;\\n  font-size: 12px;\\n}\\napp-connect-chat:host ion-row {\\n  margin-bottom: 2px;\\n}\\napp-connect-chat:host ion-footer .post-image-sec.item.item-block.item-md {\\n  max-height: 200px;\\n  overflow: hidden;\\n}\\napp-connect-chat:host ion-footer .post-image-sec.item.item-block.item-md .post-image {\\n  width: 100%;\\n  height: auto;\\n}\\napp-connect-chat:host ion-footer .send-icon {\\n  margin: -6px -6px;\\n}\\napp-connect-chat:host ion-footer .send-icon button {\\n  transform: rotate(-45deg);\\n}\\napp-connect-chat:host .connectImg {\\n  margin-top: 7px;\\n}\\napp-connect-chat:host .download-button {\\n  position: absolute;\\n  bottom: 1rem;\\n}\\napp-connect-chat:host .download-button ion-icon::before {\\n  font-size: 30px;\\n}\\napp-connect-chat:host .image-sec {\\n  background: #fff !important;\\n}\\napp-connect-chat:host .send-btn {\\n  --border-radius: 100%;\\n  width: 45px;\\n  height: 45px;\\n  --box-shadow: 0px 0px 10px #00000026;\\n}\\napp-connect-chat:host .attech-btn {\\n  --box-shadow:unset;\\n  color: black;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2Nvbm5lY3QtY2hhdC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0k7RUFDSSwwQkFBQTtBQUFSO0FBRUk7RUFDSSxXQUFBO0FBQVI7QUFFSTtFQUNJLFdBQUE7RUFDQSxZQUFBO0VBQ0EsMkJBQUE7RUFDQSxzQkFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7QUFBUjtBQUVJO0VBQ0ksZ0JBQUE7RUFDQSxtQkFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtFQUNBLDBCQUFBO0VBQUEsdUJBQUE7RUFBQSxrQkFBQTtFQUNBLFlBQUE7RUFDQSwyQkFBQTtFQUNBLDhCQUFBO0VBQ0EsaUJBQUE7QUFBUjtBQUVJO0VBQ0ksUUFBQTtFQUNBLFNBQUE7RUFDQSxXQUFBO0VBQ0EsUUFBQTtFQUNBLFdBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0VBQ0EsMkJBQUE7RUFDQSx5REFBQTtBQUFSO0FBR0k7RUFDUSxtQkFBQTtFQUNBLFlBQUE7RUFDQSxlQUFBO0VBQ0EsMEJBQUE7RUFBQSx1QkFBQTtFQUFBLGtCQUFBO0VBQ0EsNEJBQUE7RUFDQSwrQkFBQTtFQUNBLGFBQUE7RUFDQSxXQUFBO0VBQ0EsZ0JBQUE7QUFEWjtBQUdJO0VBQ0ksUUFBQTtFQUNBLFNBQUE7RUFDQSxXQUFBO0VBQ0EsUUFBQTtFQUNBLFNBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0VBQ0EsMkJBQUE7RUFDQSx5REFBQTtBQURSO0FBR0k7RUFDSSxTQUFBO0VBQ0EsVUFBQTtBQURSO0FBR0k7RUFDSSxnQkFBQTtFQUNBLFNBQUE7QUFEUjtBQUdJO0VBQ0ksaUJBQUE7RUFDQSxlQUFBO0FBRFI7QUFHSTtFQUNJLGtCQUFBO0FBRFI7QUFJUTtFQUNJLGlCQUFBO0VBQ0EsZ0JBQUE7QUFGWjtBQUdZO0VBQ0ksV0FBQTtFQUNBLFlBQUE7QUFEaEI7QUFJUTtFQUNJLGlCQUFBO0FBRlo7QUFHWTtFQUNJLHlCQUFBO0FBRGhCO0FBS0k7RUFDSSxlQUFBO0FBSFI7QUFLSTtFQUNJLGtCQUFBO0VBQ0EsWUFBQTtBQUhSO0FBSVE7RUFDSSxlQUFBO0FBRlo7QUFLSTtFQUNJLDJCQUFBO0FBSFI7QUFLSTtFQUNBLHFCQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxvQ0FBQTtBQUhKO0FBS0k7RUFDSSxrQkFBQTtFQUNBLFlBQUE7QUFIUiIsImZpbGUiOiJjb25uZWN0LWNoYXQucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiYXBwLWNvbm5lY3QtY2hhdDpob3N0IHtcclxuICAgIC5tYXJnaW50b3B7XHJcbiAgICAgICAgbWFyZ2luLXRvcDogOHB4ICFpbXBvcnRhbnQ7XHJcbiAgICB9XHJcbiAgICBoNntcclxuICAgICAgICBtYXJnaW46IDJ2dztcclxuICAgIH1cclxuICAgIC5hdmF0YXItaW1nIHtcclxuICAgICAgICB3aWR0aDogNDBweDtcclxuICAgICAgICBoZWlnaHQ6IDQwcHg7XHJcbiAgICAgICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyO1xyXG4gICAgICAgIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XHJcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgICAgIG1hcmdpbi1sZWZ0OiA5cHg7XHJcbiAgICB9XHJcbiAgICAuc2VuZGVyLW1lc3NhZ2V7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcclxuICAgICAgICBiYWNrZ3JvdW5kOiAjNDNhMDQ3O1xyXG4gICAgICAgIGNvbG9yOiAjZmZmO1xyXG4gICAgICAgIHBhZGRpbmc6IDdweDtcclxuICAgICAgICBtYXgtd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgd2lkdGg6IGZpdC1jb250ZW50O1xyXG4gICAgICAgIGZsb2F0OiByaWdodDtcclxuICAgICAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiA2cHg7XHJcbiAgICAgICAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogNnB4O1xyXG4gICAgICAgIG1hcmdpbi1yaWdodDogM3B4O1xyXG4gICAgfVxyXG4gICAgLnNlbmRlci1tZXNzYWdlLWZpcnN0LWNoaWxkOmFmdGVye1xyXG4gICAgICAgIHdpZHRoOiAwO1xyXG4gICAgICAgIGhlaWdodDogMDtcclxuICAgICAgICBjb250ZW50OiBcIlwiO1xyXG4gICAgICAgIHRvcDogNXB4O1xyXG4gICAgICAgIHJpZ2h0OiAtMXB4O1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xyXG4gICAgICAgIGJvcmRlci13aWR0aDogMTNweCAxM3B4IDAgMDtcclxuICAgICAgICBib3JkZXItY29sb3I6ICM0M2EwNDcgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLnJlY2VpdmVyLW1lc3NhZ2Uge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDBiMGZmO1xyXG4gICAgICAgICAgICBwYWRkaW5nOiA3cHg7XHJcbiAgICAgICAgICAgIG1heC13aWR0aDogMTAwJTtcclxuICAgICAgICAgICAgd2lkdGg6IGZpdC1jb250ZW50O1xyXG4gICAgICAgICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogNnB4O1xyXG4gICAgICAgICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogNnB4O1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgICAgICBjb2xvcjogI2ZmZjtcclxuICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDRweDtcclxuICAgIH1cclxuICAgIC5yZWNlaXZlci1tZXNzYWdlLWZpcnN0LWNoaWxkOmJlZm9yZSB7XHJcbiAgICAgICAgd2lkdGg6IDA7XHJcbiAgICAgICAgaGVpZ2h0OiAwO1xyXG4gICAgICAgIGNvbnRlbnQ6IFwiXCI7XHJcbiAgICAgICAgdG9wOiA1cHg7XHJcbiAgICAgICAgbGVmdDogMXB4O1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xyXG4gICAgICAgIGJvcmRlci13aWR0aDogMCAxM3B4IDEzcHggMDtcclxuICAgICAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50ICMwMGIwZmYgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7XHJcbiAgICB9XHJcbiAgICAucmVjZWl2ZXItbWVzc2FnZSB1bCB7XHJcbiAgICAgICAgbWFyZ2luOiAwO1xyXG4gICAgICAgIHBhZGRpbmc6IDA7XHJcbiAgICB9XHJcbiAgICAucmVjZWl2ZXItbWVzc2FnZSB1bCBsaSB7XHJcbiAgICAgICAgbGlzdC1zdHlsZTogbm9uZTtcclxuICAgICAgICBtYXJnaW46IDA7XHJcbiAgICB9XHJcbiAgICBsaS5zZW5kZXItbmFtZSB7XHJcbiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgICAgZm9udC1zaXplOiAxMnB4O1xyXG4gICAgfVxyXG4gICAgaW9uLXJvd3tcclxuICAgICAgICBtYXJnaW4tYm90dG9tOiAycHg7XHJcbiAgICB9XHJcbiAgICBpb24tZm9vdGVye1xyXG4gICAgICAgIC5wb3N0LWltYWdlLXNlYy5pdGVtLml0ZW0tYmxvY2suaXRlbS1tZCB7XHJcbiAgICAgICAgICAgIG1heC1oZWlnaHQ6IDIwMHB4O1xyXG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgICAgICAgICAucG9zdC1pbWFnZSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgICAgICAgICAgIGhlaWdodDogYXV0bztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAuc2VuZC1pY29ue1xyXG4gICAgICAgICAgICBtYXJnaW46IC02cHggLTZweDtcclxuICAgICAgICAgICAgYnV0dG9ue1xyXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC5jb25uZWN0SW1nIHtcclxuICAgICAgICBtYXJnaW4tdG9wOiA3cHg7XHJcbiAgICB9XHJcbiAgICAuZG93bmxvYWQtYnV0dG9uIHtcclxuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgYm90dG9tOiAxcmVtO1xyXG4gICAgICAgIGlvbi1pY29uOjpiZWZvcmUge1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDMwcHg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLmltYWdlLXNlYyB7XHJcbiAgICAgICAgYmFja2dyb3VuZDogI2ZmZiAhaW1wb3J0YW50O1xyXG4gICAgfVxyXG4gICAgLnNlbmQtYnRue1xyXG4gICAgLS1ib3JkZXItcmFkaXVzOiAxMDAlO1xyXG4gICAgd2lkdGg6IDQ1cHg7XHJcbiAgICBoZWlnaHQ6IDQ1cHg7XHJcbiAgICAtLWJveC1zaGFkb3c6IDBweCAwcHggMTBweCAjMDAwMDAwMjY7XHJcbiAgICB9XHJcbiAgICAuYXR0ZWNoLWJ0bntcclxuICAgICAgICAtLWJveC1zaGFkb3c6dW5zZXQ7XHJcbiAgICAgICAgY29sb3I6YmxhY2s7XHJcbiAgICB9XHJcbn1cclxuIl19 */\";","import { Component, OnInit,NgZone, ViewChild } from '@angular/core';\nimport { NavController, NavParams, AlertController,IonContent, Platform,ModalController } from '@ionic/angular';\nimport { AuthService } from '../service/auth/auth.service';\nimport { DataService } from '../service/data/data.service';\nimport { TranslateService } from '@ngx-translate/core';\n//import { TabsPage } from '../tabs/tabs';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\nimport { Network } from '@ionic-native/network/ngx';\nimport { Router, ActivatedRoute, NavigationExtras } from '@angular/router';\nimport {Location} from '@angular/common'; \nimport { PhotoViewer } from '@ionic-native/photo-viewer/ngx';\n\n@Component({\n  selector: 'app-connect-chat',\n  templateUrl: './connect-chat.page.html',\n  styleUrls: ['./connect-chat.page.scss'],\n})\nexport class ConnectChatPage implements OnInit {\n\n//  @ViewChild(IonContent) contentArea: IonContent;\n  @ViewChild('contentArea') private contentArea: any;\n\n  /**\n   * @member userDetails Contains the user details who is logged in from local storage\n   * @member chat used to store the chat infromation coming from last page\n   * @member message typing meessage\n   * @member messages contains all the messages\n   * @member lastMessageId contains the id of last message\n   * @member chatInterval will store the interval \n   * @member lang Contains the language translation object\n   */\n  userDetails: any = {};\n  chat: any = {};\n  message: string = \"\";\n  messages: any = [];\n  lastMessageId: number = 0;\n  chatInterval: any;\n  attachment:string = '';\n  lang:any = {}\n  image:string = '';\n  navData:any;\n  \n  /**\n   * Class list constructor\n   * @param navCtrl Use for navigation between pages\n   * @param app   Root app \n   * @param dataProvider  Use for getting data from the API\n   * @param authProvider  Use for authentication purpose\n   * @param viewCtrl View controller \n   */\n  constructor(public navCtrl: NavController, \n  \t\t\t//  public viewCtrl: ViewController, \n  \t\t\t//  public app: App,\n  \t\t\t  public translate: TranslateService,\n    \t\t  public dataProvider: DataService, \n    \t\t  public authProvider: AuthService, \n    \t\t // public navParams: NavParams, \n    \t\t  public alertCtrl: AlertController,\n              private _location: Location,\n              private photoViewer: PhotoViewer,\n                private router:Router,\n              private route : ActivatedRoute,\n    public camera: Camera) {\n  \t  \tthis.route.queryParams.subscribe(params => {\n\t      if (this.router.getCurrentNavigation().extras.state) {\n\t      \t\t this.chat = this.router.getCurrentNavigation().extras.state;\n             console.log(this.navData);\n                 this.userDetails = JSON.parse(localStorage.getItem(\"userloggedin\"));\n                 console.log(this.userDetails);\n\t\t    this.messages.push({\n\t\t      datetime: this.chat.created,\n\t\t      message: this.chat.message,\n\t\t      receiver: this.userDetails.details.user_type == '1' ? 'true' : 'false',\n\t\t      msg_from: this.chat.parent_user_no,\n\t\t      msg_to: this.chat.school_id,\n\t\t      attachment_url: this.chat.message_image,\n\t\t      id: 0\n\t\t    });\n\t\t    this.getInitialChat();\n\t\t    this.chatInterval = setInterval(() => {\n\t\t      this.getChats(this.lastMessageId);\n\t\t    }, 5000);\n\t      }\n\t    });\n      this.translate.get(\"alertmessages\").subscribe((response) => {\n        this.lang = response;\n      })\n  }\n\n  /**\n   * Ionic navigation event will run when page is loaded\n   */\n  ionViewWillEnter() {\n  }\n    showPhoto(url){\n    this.photoViewer.show(url);\n  }\n\n  /**\n   * Get the initial chat when user comes to this page\n   */\n  getInitialChat() {\n    this.dataProvider.showLoading();\n    let data = {\n      user_no: this.userDetails.details.user_no,\n      school_id: this.userDetails.details.school_id,\n      user_type: this.userDetails.details.user_type,\n      session_id: this.userDetails.session_id,\n      chat_id: this.chat.id,\n      last_msg_id: 0\n    }\n    this.dataProvider.getParentConnectChatMessages(data).then((response) => {\n      this.dataProvider.hideLoading();\n      if (response.session) {\n        let length = response.chat.length;\n        if (length > 0) {\n          response.chat.forEach((message) => {\n            this.messages.push(message)\n          })\n          this.lastMessageId = response.chat[length - 1].id;\n          setTimeout(() => {\n            if (this.contentArea) {\n              this.contentArea.scrollToBottom(300);\n            }\n          });\n        }\n      } else {\n       // this.authProvider.flushLocalStorage();\n        this.dataProvider.errorALertMessage(response.message);\n       this.router.navigate(['login'], { replaceUrl: true });\n      }\n    }).catch((error) => {\n      this.dataProvider.hideLoading();\n      // this.dataProvider.errorALertMessage(error);\n    })\n  }\n\n  /**\n   * Get the chat after the last message\n   * @param lastMessageId Contains the last message id\n   */\n  getChats(lastMessageId) {\n    let data = {\n      user_no: this.userDetails.details.user_no,\n      school_id: this.userDetails.details.school_id,\n      user_type: this.userDetails.details.user_type,\n      session_id: this.userDetails.session_id,\n      chat_id: this.chat.id,\n      last_msg_id: lastMessageId\n    }\n    this.dataProvider.getParentConnectChatMessages(data).then((response) => {\n      if (response.session) {\n        let length = response.chat.length;\n        if (length > 0) {\n          let msgLength = this.messages.length;\n          response.chat.forEach((message) => {\n            if (message.id < this.messages[msgLength - 1].id) {\n              this.messages.push(message);\n            } else {\n              let msg = this.messages.filter((oldMsg) => {\n                return oldMsg.id == message.id;\n              })\n              if (msg.length == 0) {\n                this.messages.push(message);\n              }\n            }\n          })\n          setTimeout(() => {\n            if (this.contentArea._scroll) {\n              this.contentArea.scrollToBottom(10)\n            }\n          });\n          this.lastMessageId = response.chat[length - 1].id;\n        }\n      } else {\n       // this.authProvider.flushLocalStorage();\n        this.dataProvider.errorALertMessage(response.message);\n       this.router.navigate(['login'], { replaceUrl: true });\n      }\n    }).catch((error) => {\n      // this.dataProvider.errorALertMessage(error);\n      console.log(error);\n    })\n  }\n\n  /**\n   * Used to dismiss the modal opened for the chat\n   */\n  dismiss() {\n    if (this.chatInterval) {\n      clearInterval(this.chatInterval);\n    }\n    this._location.back();\n    // this.viewCtrl.dismiss();\n  }\n\n  /**\n   * Send the message to provider\n   */\n  sendMessage() {\n    if ((this.message && this.message.trim() != '') || this.attachment != '') {\n      if (this.message.length > 140) {\n        this.dataProvider.showToast(this.lang.max_body)\n      } else {\n        this.image = '';\n        this.dataProvider.showLoading();\n        let data = {};\n        if (this.userDetails.details.user_type == '4' || this.userDetails.details.user_type == '8') {\n          data = {\n            session_id: this.userDetails.session_id,\n            user_no: this.userDetails.details.user_no,\n            user_type: this.userDetails.details.user_type,\n            chat_msg: {\n              connect_id: this.chat.id,\n              msg_from: this.userDetails.details.user_no,\n              msg_to: this.userDetails.details.school_id,\n              message: this.message,\n              attachment_url: this.attachment\n            }\n          }\n        } else if (this.userDetails.details.user_type == '1') {\n          data = {\n            session_id: this.userDetails.session_id,\n            user_no: this.userDetails.details.user_no,\n            user_type: this.userDetails.details.user_type,\n            chat_msg: {\n              connect_id: this.chat.id,\n              msg_from: this.userDetails.details.school_id,\n              msg_to: this.chat.parent_user_no,\n              admin_user_no: this.userDetails.details.user_no,\n              message: this.message,\n              attachment_url: this.attachment\n            }\n          }\n        }\n        this.dataProvider.sendParentConnectChatMsg(data).then((response) => {\n          this.dataProvider.hideLoading();\n          if (response.session) {\n            this.dataProvider.showToast(response.message);\n            if (this.lastMessageId < response.msg_id) {\n              if(response.attachment_url){\n                this.messages.push({\n                  receiver: 'false',\n                  message: this.message,\n                  id: response.msg_id,\n                  attachment_url: response.attachment_url\n                });\n              }else{\n                this.messages.push({\n                  receiver: 'false',\n                  message: this.message,\n                  id: response.msg_id\n                });\n              }\n              setTimeout(() => {\n                if (this.contentArea._scroll) {\n                  this.contentArea.scrollToBottom(10)\n                }\n              });\n            }\n            this.message = '';\n            this.attachment = '';\n          } else {\n           // this.authProvider.flushLocalStorage();\n            this.dataProvider.errorALertMessage(response.message);\n           this.router.navigate(['login'], { replaceUrl: true });\n          }\n        }).catch((error) => {\n          this.dataProvider.hideLoading();\n          this.dataProvider.errorALertMessage(error);\n        })\n      }\n    }\n  }\n\n  /**\n   * alert to show image take choice\n   */\n async takePicture(){\n  const alert=await this.alertCtrl.create({\n      header: this.lang.image_option,\n      buttons: [\n        {\n          text: this.lang.camera,\n          handler: ()=>{\n            this.openCamera();\n          }\n        },\n        {\n          text: this.lang.gallery,\n          handler: ()=>{\n            this.openGallery()\n          }\n        }\n      ]\n    })\n  await alert.present();\n  }\n\n  /**\n   * mobile camera to take image \n   */\n  openCamera(){\n    let options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.PNG,\n      mediaType: this.camera.MediaType.PICTURE,\n      allowEdit: true,\n      correctOrientation: true,\n      sourceType: this.camera.PictureSourceType.CAMERA,\n      targetHeight: 500,\n      targetWidth: 500\n    }\n\n    this.camera.getPicture(options).then((imageData)=>{\n      if(imageData){\n        this.attachment = \"data:image/png;base64,\"+imageData;\n        this.image = 'data:image/jpeg;base64,'+imageData;\n      }\n    })\n  }\n\n  /**\n   * Open gallery to take image\n   */\n  openGallery(){\n    let options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.PNG,\n      mediaType: this.camera.MediaType.PICTURE,\n      allowEdit: true,\n      correctOrientation: true,\n      sourceType: this.camera.PictureSourceType.PHOTOLIBRARY,\n      targetHeight: 500,\n      targetWidth: 500\n    }\n\n    this.camera.getPicture(options).then((imageData)=>{\n      if(imageData){\n        this.attachment = \"data:image/png;base64,\"+imageData;\n        this.image = 'data:image/jpeg;base64,'+imageData;\n      }\n    })\n  }\n\n  downloadImage(imageUrl){\n    this.dataProvider.showLoading();\n    this.dataProvider.downloadImage(imageUrl).then((res)=>{\n      this.dataProvider.hideLoading();\n      this.dataProvider.showToast(this.lang.download_complete);\n    }).catch((error)=>{\n      this.dataProvider.hideLoading();\n      this.dataProvider.errorALertMessage(error);\n    })\n  }\n\n\n  ngOnInit() {\n  } \n\n}\n","export default \"<ion-header mode=\\\"md\\\">\\n  <ion-toolbar>\\n  \\t<ion-buttons slot=\\\"end\\\">\\n  \\t\\t<ion-back-button>\\n  \\t\\t</ion-back-button>\\n  \\t</ion-buttons>\\n\\n    <ion-row no-padding no-margin *ngIf=\\\"chat\\\">\\n      <ion-col size=\\\"2\\\" no-padding no-margin>\\n        <img class=\\\"avatar-img\\\" [src]=\\\"chat.pic\\\" onerror=\\\"this.onerror=null;this.src='assets/imgs/logo.png';\\\" imageViewer  (click)=\\\"showPhoto(chat.pic)\\\"/>\\n      </ion-col>\\n      <ion-col size=\\\"10\\\" align-self-center no-padding no-margin text-right>\\n        <h6>{{chat.name}}</h6>\\n      </ion-col>\\n    </ion-row> \\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding #contentArea class=\\\"right-direction\\\" mode=\\\"md\\\">\\n  <div *ngFor=\\\"let message of messages; let i = index\\\">\\n    <ion-row *ngIf=\\\"message.receiver == 'false'\\\"\\n      [class.margintop]=\\\"i > 0 && messages[i-1].receiver != message.receiver\\\">\\n      <ion-col size=\\\"4\\\" align-self-center no-padding></ion-col>\\n      <ion-col size=\\\"8\\\" align-self-center text-right no-padding>\\n        <div class=\\\"sender-message\\\"\\n          [class.sender-message-first-child]=\\\"(i > 0 && messages[i-1].receiver != message.receiver) || i==0\\\">\\n          <span>{{message.message}}</span>\\n          <div class=\\\"image-sec\\\" *ngIf=\\\"message.attachment_url != '' && message.attachment_url != undefined\\\">\\n            <img class=\\\"connectImg\\\" [src]=\\\"message.attachment_url\\\" imageViewer (click)=\\\"showPhoto(message.attachment_url)\\\" />\\n          </div>\\n        </div>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row *ngIf=\\\"message.receiver == 'true'\\\" [class.margintop]=\\\"i > 0 && messages[i-1].receiver != message.receiver\\\">\\n      <ion-col size=\\\"8\\\" align-self-center no-padding>\\n        <div class=\\\"receiver-message\\\"\\n          [class.receiver-message-first-child]=\\\"(i > 0 && messages[i-1].receiver != message.receiver) || i==0\\\">\\n          <ul>\\n            <li class=\\\"sender-name\\\">{{message.senderName}}</li>\\n            <li>{{message.message}}</li>\\n            <li class=\\\"image-sec\\\" *ngIf=\\\"message.attachment_url != '' && message.attachment_url != undefined\\\">\\n              <img class=\\\"connectImg\\\" [src]=\\\"message.attachment_url\\\" imageViewer (click)=\\\"showPhoto(message.attachment_url)\\\" />\\n              <div class=\\\"download-button\\\">\\n                <ion-button ion-button small icon-only outline color=\\\"white\\\" (click)=\\\"downloadImage(message.attachment_url)\\\">\\n                  <ion-icon name=\\\"download\\\" color=\\\"dark\\\" style=\\\"font-size: 25px;\\\"></ion-icon>\\n                </ion-button>\\n              </div>\\n            </li>\\n          </ul>\\n        </div>\\n      </ion-col>\\n      <ion-col size=\\\"4\\\" align-self-center no-padding></ion-col>\\n    </ion-row>\\n  </div>\\n</ion-content>\\n<ion-footer *ngIf=\\\"chat && chat.ticket_status == '0'\\\" style=\\\"background: #fff;color: #000;\\\">\\n  <ion-item class=\\\"post-image-sec\\\" *ngIf=\\\"image != ''\\\">\\n    <img [src]=\\\"image\\\" class=\\\"post-image\\\" />\\n  </ion-item>\\n  <ion-row>\\n    <ion-col size=\\\"8.5\\\">\\n      <ion-input class=\\\"message\\\" [(ngModel)]=\\\"message\\\" text-right\\n        placeholder=\\\"{{'parentconnect_chat.typehere'| translate}}\\\"></ion-input>\\n    </ion-col>\\n    <ion-col size=\\\"1.5\\\">\\n      <ion-button class=\\\"attech-btn\\\"  clear small icon-only color=\\\"menu-color\\\" (click)=\\\"takePicture()\\\">\\n        <ion-icon name=\\\"attach\\\" style=\\\"color:#000\\\"></ion-icon>\\n      </ion-button>\\n    </ion-col>\\n    <ion-col size=\\\"2\\\" class=\\\"send-icon\\\">\\n      <ion-fab>\\n        <ion-button ion-fab mini class=\\\"send-btn\\\"  (click)=\\\"sendMessage()\\\">\\n          <ion-icon name=\\\"send\\\"></ion-icon>\\n        </ion-button>\\n      </ion-fab>\\n    </ion-col>\\n  </ion-row>\\n</ion-footer>\";"]}